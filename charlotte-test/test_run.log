Starting train_SC_venv.sh-----------
Using venv (not conda)
  Sound venv:  /Users/ringger/Projects/brendan/SCIMT/venv_sound
  Copper venv: /Users/ringger/Projects/brendan/SCIMT/venv_copper
Mon Oct 13 20:39:27 MDT 2025
-------------------------------
    ###############################################
#-- #                 1) ARGUMENTS                # --#
    ###############################################
Arguments:-
    MODULE_HOME_DIR=/Users/ringger/Projects/brendan/SCIMT

    SRC=es
    TGT=an
    PARALLEL_TRAIN=/Users/ringger/charlotte-test/data/csv/train.no_overlap_v1.csv
    PARALLEL_VAL=/Users/ringger/charlotte-test/data/csv/val.no_overlap_v1.csv
    PARALLEL_TEST=/Users/ringger/charlotte-test/data/csv/test.csv
    COGNATE_TRAIN=/Users/ringger/charlotte-test/cognates
    NO_GROUPING=true
    SC_MODEL_TYPE=SMT
    SEED=1000
    COGNATE_THRESH=0.5
    COPPERMT_DATA_DIR=/Users/ringger/charlotte-test/sc_models
    COPPERMT_DIR=/Users/ringger/Projects/brendan/SCIMT/CopperMT/CopperMT
    PARAMETERS_DIR=/Users/ringger/charlotte-test/params
    RNN_HYPERPARAMS=/Users/ringger/Projects/brendan/SCIMT/Pipeline/rnn_hyperparams
    RNN_HYPERPARAMS_ID=default
    BEAM=5
    NBEST=1
    REVERSE_SRC_TGT_COGNATES=false
    ADDITIONAL_TRAIN_COGNATES_SRC=null
    ADDITIONAL_TRAIN_COGNATES_TGT=null
    VAL_COGNATES_SRC=null
    VAL_COGNATES_TGT=null
    TEST_COGNATES_SRC=null
    TEST_COGNATES_TGT=null
    COGNATE_TRAIN_RATIO=0.8
    COGNATE_TEST_RATIO=0.1
    COGNATE_VAL_RATIO=0.1
-------------------------------




    ###############################################
#-- #     2) GET COGNATES FROM PARALLEL DATA      # --#
    ###############################################


######## 2.1 Clear and remake COGNATE_TRAIN dir ########
removing /Users/ringger/charlotte-test/cognates_SMT-default_S-1000
creating /Users/ringger/charlotte-test/cognates_SMT-default_S-1000
creating /Users/ringger/charlotte-test/cognates_SMT-default_S-1000/cognate
creating /Users/ringger/charlotte-test/cognates_SMT-default_S-1000/fastalign


######## 2.2 Gather parallel data from which cognates are extracted ########
MultilingualDataset READING CSV /Users/ringger/charlotte-test/data/csv/train.no_overlap_v1.csv
Reading all lines from /Users/ringger/charlotte-test/data/raw/train.es
Reading all lines from /Users/ringger/charlotte-test/data/raw/train.an
Making unique: ('es', 'an')
	Before unique: 3
	After unique: 3
However, we will not use the unique data by pairs.
(Will use the 'Before unique' dataset sizes)
DATA MAX_SIZE = 3
RAW DATA SIZE: 3
UPSAMPLED SIZE: 3
RETURNING SRC PATHS: ['/Users/ringger/charlotte-test/data/raw/train.es']
RETURNING TGT PATHS: ['/Users/ringger/charlotte-test/data/raw/train.an']
MultilingualDataset TOTAL PAIRS: 3
MultilingualDataset READING CSV /Users/ringger/charlotte-test/data/csv/val.no_overlap_v1.csv
Reading all lines from /Users/ringger/charlotte-test/data/raw/train.es
Reading all lines from /Users/ringger/charlotte-test/data/raw/train.an
Making unique: ('es', 'an')
	Before unique: 3
	After unique: 3
However, we will not use the unique data by pairs.
(Will use the 'Before unique' dataset sizes)
DATA MAX_SIZE = 3
RAW DATA SIZE: 3
UPSAMPLED SIZE: 3
RETURNING SRC PATHS: ['/Users/ringger/charlotte-test/data/raw/train.es']
RETURNING TGT PATHS: ['/Users/ringger/charlotte-test/data/raw/train.an']
MultilingualDataset TOTAL PAIRS: 3
MultilingualDataset READING CSV /Users/ringger/charlotte-test/data/csv/test.csv
Reading all lines from /Users/ringger/charlotte-test/data/raw/train.es
Reading all lines from /Users/ringger/charlotte-test/data/raw/train.an
Making unique: ('es', 'an')
	Before unique: 3
	After unique: 3
However, we will not use the unique data by pairs.
(Will use the 'Before unique' dataset sizes)
DATA MAX_SIZE = 3
RAW DATA SIZE: 3
UPSAMPLED SIZE: 3
RETURNING SRC PATHS: ['/Users/ringger/charlotte-test/data/raw/train.es']
RETURNING TGT PATHS: ['/Users/ringger/charlotte-test/data/raw/train.an']
MultilingualDataset TOTAL PAIRS: 3
############################
# make_SC_training_data.py #
############################
Arguments:-
	-train_csv: /Users/ringger/charlotte-test/data/csv/train.no_overlap_v1.csv
	-val_csv: /Users/ringger/charlotte-test/data/csv/val.no_overlap_v1.csv
	-test_csv: /Users/ringger/charlotte-test/data/csv/test.csv
	-src_out: /Users/ringger/charlotte-test/cognates_SMT-default_S-1000/cognate/train.es
	-tgt_out: /Users/ringger/charlotte-test/cognates_SMT-default_S-1000/cognate/train.an
	-src: es
	-tgt: an
------------------------------



######## 2.3 Run Fast Align ########

# 2.3.1 set file path names depending on whether NO_GROUPING is set to true or false. #
NO_GROUPING has been set to true.
t/Users/ringger/charlotte-test/cognates_SMT-default_S-1000/fastalign/word_list.es-an.NG.txt

# 2.3.2 preparing for fast align #
prepare_for_fastalign.py REVERSE=false
###########################
# prepare_for_fastlign.py #
###########################
arguments
src: '/Users/ringger/charlotte-test/cognates_SMT-default_S-1000/cognate/train.es'
tgt: '/Users/ringger/charlotte-test/cognates_SMT-default_S-1000/cognate/train.an'
out: '/Users/ringger/charlotte-test/cognates_SMT-default_S-1000/fastalign/es-an.txt'
------------------


src_tokenize=spacy_tokenize, lang: es
tgt_tokenize=spacy_tokenize, lang: an
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 18743.17it/s]
Writing prepare_for_fastalign.py output to /Users/ringger/charlotte-test/cognates_SMT-default_S-1000/fastalign/es-an.txt


# 2.3.3 fast_align #
ARG=i
ARG=d
ARG=o
ARG=v
INITIAL PASS 
expected target length = source length * 1
ITERATION 1
  log_e likelihood: -870.377
  log_2 likelihood: -1255.69
     cross entropy: 29.8974
        perplexity: 1e+09
      posterior p0: 0.08
 posterior al-feat: -0.233206
       size counts: 2
ITERATION 2
  log_e likelihood: -60.9453
  log_2 likelihood: -87.9255
     cross entropy: 2.09347
        perplexity: 4.26772
      posterior p0: 0.00910933
 posterior al-feat: -0.21054
       size counts: 2
  1  model al-feat: -0.14086 (tension=4)
  2  model al-feat: -0.19077 (tension=2.60641)
  3  model al-feat: -0.207513 (tension=2.211)
  4  model al-feat: -0.210175 (tension=2.15046)
  5  model al-feat: -0.210498 (tension=2.14317)
  6  model al-feat: -0.210535 (tension=2.14233)
  7  model al-feat: -0.210539 (tension=2.14223)
  8  model al-feat: -0.21054 (tension=2.14222)
     final tension: 2.14222
ITERATION 3
  log_e likelihood: -50.5221
  log_2 likelihood: -72.888
     cross entropy: 1.73543
        perplexity: 3.32979
      posterior p0: 0.00307314
 posterior al-feat: -0.213369
       size counts: 2
  1  model al-feat: -0.21054 (tension=2.14222)
  2  model al-feat: -0.213055 (tension=2.08564)
  3  model al-feat: -0.213336 (tension=2.07935)
  4  model al-feat: -0.213365 (tension=2.07868)
  5  model al-feat: -0.213369 (tension=2.07861)
  6  model al-feat: -0.213369 (tension=2.0786)
  7  model al-feat: -0.213369 (tension=2.0786)
  8  model al-feat: -0.213369 (tension=2.0786)
     final tension: 2.0786
ITERATION 4
  log_e likelihood: -46.0995
  log_2 likelihood: -66.5075
     cross entropy: 1.58351
        perplexity: 2.99699
      posterior p0: 0.0016351
 posterior al-feat: -0.213935
       size counts: 2
  1  model al-feat: -0.213369 (tension=2.0786)
  2  model al-feat: -0.213875 (tension=2.06729)
  3  model al-feat: -0.213928 (tension=2.0661)
  4  model al-feat: -0.213934 (tension=2.06598)
  5  model al-feat: -0.213934 (tension=2.06596)
  6  model al-feat: -0.213934 (tension=2.06596)
  7  model al-feat: -0.213935 (tension=2.06596)
  8  model al-feat: -0.213935 (tension=2.06596)
     final tension: 2.06596
ITERATION 5 (FINAL)
  log_e likelihood: -46.0502
  log_2 likelihood: -66.4364
     cross entropy: 1.58182
        perplexity: 2.99347
      posterior p0: 0
 posterior al-feat: 0
       size counts: 2
ARG=i
ARG=d
ARG=o
ARG=v
ARG=r
INITIAL PASS 
expected target length = source length * 1
ITERATION 1
  log_e likelihood: -870.377
  log_2 likelihood: -1255.69
     cross entropy: 29.8974
        perplexity: 1e+09
      posterior p0: 0.08
 posterior al-feat: -0.233206
       size counts: 2
ITERATION 2
  log_e likelihood: -60.9453
  log_2 likelihood: -87.9255
     cross entropy: 2.09347
        perplexity: 4.26772
      posterior p0: 0.00910933
 posterior al-feat: -0.21054
       size counts: 2
  1  model al-feat: -0.14086 (tension=4)
  2  model al-feat: -0.19077 (tension=2.60641)
  3  model al-feat: -0.207513 (tension=2.211)
  4  model al-feat: -0.210175 (tension=2.15046)
  5  model al-feat: -0.210498 (tension=2.14317)
  6  model al-feat: -0.210535 (tension=2.14233)
  7  model al-feat: -0.210539 (tension=2.14223)
  8  model al-feat: -0.21054 (tension=2.14222)
     final tension: 2.14222
ITERATION 3
  log_e likelihood: -50.5221
  log_2 likelihood: -72.888
     cross entropy: 1.73543
        perplexity: 3.32979
      posterior p0: 0.00307314
 posterior al-feat: -0.213369
       size counts: 2
  1  model al-feat: -0.21054 (tension=2.14222)
  2  model al-feat: -0.213055 (tension=2.08564)
  3  model al-feat: -0.213336 (tension=2.07935)
  4  model al-feat: -0.213365 (tension=2.07868)
  5  model al-feat: -0.213369 (tension=2.07861)
  6  model al-feat: -0.213369 (tension=2.0786)
  7  model al-feat: -0.213369 (tension=2.0786)
  8  model al-feat: -0.213369 (tension=2.0786)
     final tension: 2.0786
ITERATION 4
  log_e likelihood: -46.0995
  log_2 likelihood: -66.5075
     cross entropy: 1.58351
        perplexity: 2.99699
      posterior p0: 0.0016351
 posterior al-feat: -0.213935
       size counts: 2
  1  model al-feat: -0.213369 (tension=2.0786)
  2  model al-feat: -0.213875 (tension=2.06729)
  3  model al-feat: -0.213928 (tension=2.0661)
  4  model al-feat: -0.213934 (tension=2.06598)
  5  model al-feat: -0.213934 (tension=2.06596)
  6  model al-feat: -0.213934 (tension=2.06596)
  7  model al-feat: -0.213935 (tension=2.06596)
  8  model al-feat: -0.213935 (tension=2.06596)
     final tension: 2.06596
ITERATION 5 (FINAL)
  log_e likelihood: -46.0502
  log_2 likelihood: -66.4364
     cross entropy: 1.58182
        perplexity: 2.99347
      posterior p0: 0
 posterior al-feat: 0
       size counts: 2


######## 2.4 Get Cognates ########

# 2.4.1 make word alignments #
NO_GROUPING=true: running make_word_alignments_no_grouping.py
make_word_alignments_no_grouping.py
arguments:
	alignments: '/Users/ringger/charlotte-test/cognates_SMT-default_S-1000/fastalign/es-an.sym.align'
	sent_pairs: '/Users/ringger/charlotte-test/cognates_SMT-default_S-1000/fastalign/es-an.txt'
	out: '/Users/ringger/charlotte-test/cognates_SMT-default_S-1000/fastalign/word_list.es-an.NG.txt'
	VERBOSE: 'False'
	STOP: 'None'
---------------------


  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 128397.06it/s]
0 sentence pairs have a NBSP

# 2.4.2 Get cognates from word list #
make_cognate_list.py REVERSE=false
make_cognate_list.py
arguments
	word_list: /Users/ringger/charlotte-test/cognates_SMT-default_S-1000/fastalign/word_list.es-an.NG.txt
	out: None
	theta: 0.5
	src: es
	tgt: an
-------------------


- FOUND 7 COGNATES -




    ###############################################
#-- #      3) TRAIN SC MODEL WITH COPPER MT       # --#
    ###############################################


######## 3.1 Make cognate prediction training, validation, and test sets ########

# 3.1 if needed, make dataset splits #
Splitting cognate data /Users/ringger/charlotte-test/cognates_SMT-default_S-1000/fastalign/word_list.es-an.NG.cognates.0.5.parallel-es.txt, /Users/ringger/charlotte-test/cognates_SMT-default_S-1000/fastalign/word_list.es-an.NG.cognates.0.5.parallel-an.txt
    (train:val:test) 0.8:0.1:0.1
Pipeline/train_SC_venv.sh: line 306: -3: substring expression < 0

# 3.1.2 Include ADDITIONAL_TRAIN_COGNATES_SRC and ADDITIONAL_TRAIN_COGNATES_TGT in train set file paths #

# 3.1.3 Print out files for train, validation, and test sets #
Cognate training data for format_data.py is as follows:
    TRAIN_COGNATES_SRC=
    TRAIN_COGNATES_TGT=
    VAL_COGNATES_SRC=null
    VAL_COGNATES_TGT=null
    TEST_COGNATES_SRC=null
    TEST_COGNATES_TGT=null



######## 3.2 Train CopperMT cognate prediction model ########

# 3.2.1 make directory structure for CopperMT inputs and outputs #
COPPER_DIR: /Users/ringger/charlotte-test/sc_models/es_an_SMT-default_S-1000

creating /Users/ringger/charlotte-test/sc_models/es_an_SMT-default_S-1000

# 3.2.2 Copy the RNN hyperparams set file, corresponding to RNN_HYPERPARAMS_ID, to its place in the COPPERMT inputs/outputs folder #

# 3.2.3 Format the cognate train, val, test data for CopperMT #

usage: format_data.py [-h] [--src_data SRC_DATA] [--tgt_data TGT_DATA]
                      [--src SRC] [--tgt TGT] [--out_dir OUT_DIR]
                      [--prefix {test,train,fine_tune}] [--seed SEED]
                      [--EXCLUDE_SRC EXCLUDE_SRC] [--EXCLUDE_TGT EXCLUDE_TGT]
format_data.py: error: argument --src_data: expected one argument
##################
# format_data.py #
##################
